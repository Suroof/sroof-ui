// --- CSS 变量定义 ---
:root {
  --progress-primary-start: #667eea;
  --progress-primary-end: #764ba2;
  --progress-success-start: #11998e;
  --progress-success-end: #38ef7d;
  --progress-warning-start: #f093fb;
  --progress-warning-end: #f5576c;
  --progress-track-bg: #f1f3f4;
  --progress-track-border: #e8eaed;
  --progress-text-color: #3c4043;
  --progress-shadow-light: rgba(255, 255, 255, 0.8);
  --progress-shadow-dark: rgba(0, 0, 0, 0.1);
}

// --- 主容器样式 ---
.progressWrapper {
  width: 100%;
  position: relative;
  
  // 支持用户动画偏好设置
  @media (prefers-reduced-motion: reduce) {
    * {
      animation: none !important;
      transition: none !important;
    }
  }
}

// --- 线性进度条样式 ---
.linearContainer {
  display: flex;
  align-items: center;
  gap: 16px;
  position: relative;
  
  &.pulse {
    animation: pulse 2s ease-in-out infinite;
  }
}

.linearTrack {
  flex-grow: 1;
  background: linear-gradient(145deg, var(--progress-track-bg), #e9ecef);
  border: 1px solid var(--progress-track-border);
  border-radius: 50px;
  overflow: hidden;
  position: relative;
  box-shadow: 
    inset 0 2px 4px var(--progress-shadow-dark),
    0 1px 2px rgba(255, 255, 255, 0.8);
  
  // 内部光效
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 50%;
    background: linear-gradient(180deg, var(--progress-shadow-light), transparent);
    border-radius: 50px 50px 0 0;
    pointer-events: none;
  }

  // 尺寸变体
  &.linear-small { 
    height: 8px; 
    border-radius: 4px;
    &::before { border-radius: 4px 4px 0 0; }
  }
  &.linear-medium { 
    height: 12px; 
    border-radius: 6px;
    &::before { border-radius: 6px 6px 0 0; }
  }
  &.linear-large { 
    height: 18px; 
    border-radius: 9px;
    &::before { border-radius: 9px 9px 0 0; }
  }
}

.linearBar {
  height: 100%;
  border-radius: inherit;
  background: linear-gradient(135deg, var(--progress-primary-start), var(--progress-primary-end));
  position: relative;
  overflow: hidden;
  transition: 
    width 0.8s cubic-bezier(0.4, 0, 0.2, 1),
    box-shadow 0.3s ease;
  
  // 内部高光效果
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 50%;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.4), transparent);
    border-radius: inherit;
  }
  
  // 悬停效果
  .linearContainer:hover & {
    box-shadow: 
      0 0 20px rgba(102, 126, 234, 0.4),
      inset 0 1px 0 rgba(255, 255, 255, 0.3);
    transform: scaleY(1.05);
  }
  
  &.animated {
    animation: shimmer 2s ease-in-out infinite;
  }
  
  &.striped {
    background-image: 
      linear-gradient(135deg, var(--progress-primary-start), var(--progress-primary-end)),
      linear-gradient(45deg, 
        rgba(255,255,255,0.15) 25%, 
        transparent 25%, 
        transparent 50%, 
        rgba(255,255,255,0.15) 50%, 
        rgba(255,255,255,0.15) 75%, 
        transparent 75%);
    background-size: 100% 100%, 20px 20px;
    animation: stripes 1s linear infinite;
  }
}

.percentageText {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-weight: 600;
  color: var(--progress-text-color);
  text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
  transition: all 0.3s ease;
  white-space: nowrap;
  
  &.percentage-small { font-size: 12px; }
  &.percentage-medium { font-size: 14px; }
  &.percentage-large { font-size: 16px; }
}

// --- 圆形进度条样式 ---
.circularContainer {
  position: relative;
  display: inline-block;
  
  &.pulse {
    animation: pulse 2s ease-in-out infinite;
  }
  
  // 尺寸变体
  &.circular-small { 
    width: 80px; 
    height: 80px; 
  }
  &.circular-medium { 
    width: 120px; 
    height: 120px; 
  }
  &.circular-large { 
    width: 160px; 
    height: 160px; 
  }
  
  // 悬停效果
  &:hover {
    transform: scale(1.02);
    transition: transform 0.3s ease;
  }
}

.circularSvg {
  width: 100%;
  height: 100%;
  transform: rotate(-90deg);
  filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
}

.circularTrack,
.circularBar {
  fill: none;
  stroke-linecap: round;
}

.circularTrack {
  stroke: var(--progress-track-bg);
  stroke-width: 8;
  opacity: 0.3;
}

.circularBar {
  stroke: url(#progressGradient);
  stroke-width: 8;
  transition: 
    stroke-dashoffset 0.8s cubic-bezier(0.4, 0, 0.2, 1),
    stroke 0.3s ease;
  
  // 发光效果
  filter: drop-shadow(0 0 8px rgba(102, 126, 234, 0.3));
}

.percentageTextCircular {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-weight: 700;
  color: var(--progress-text-color);
  text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
  transition: all 0.3s ease;
  
  &.percentage-circular-small { font-size: 14px; }
  &.percentage-circular-medium { font-size: 18px; }
  &.percentage-circular-large { font-size: 24px; }
}

// --- 动画定义 ---
@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

@keyframes stripes {
  0% {
    background-position: 0 0, 0 0;
  }
  100% {
    background-position: 0 0, 20px 0;
  }
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.8;
    transform: scale(1.02);
  }
}

// --- 响应式设计 ---
@media (max-width: 768px) {
  .linearContainer {
    gap: 12px;
  }
  
  .percentageText {
    font-size: 12px !important;
  }
  
  .circularContainer {
    &.circular-small { width: 60px; height: 60px; }
    &.circular-medium { width: 80px; height: 80px; }
    &.circular-large { width: 100px; height: 100px; }
  }
  
  .percentageTextCircular {
    &.percentage-circular-small { font-size: 10px; }
    &.percentage-circular-medium { font-size: 12px; }
    &.percentage-circular-large { font-size: 16px; }
  }
}

// --- 高对比度模式支持 ---
@media (prefers-contrast: high) {
  .linearTrack {
    border: 2px solid #000;
    background: #fff;
  }
  
  .linearBar {
    background: #000 !important;
  }
  
  .circularTrack {
    stroke: #ccc;
    stroke-width: 10;
  }
  
  .circularBar {
    stroke: #000 !important;
    stroke-width: 10;
  }
}

// --- 暗色主题支持 ---
@media (prefers-color-scheme: dark) {
  :root {
    --progress-track-bg: #2d3748;
    --progress-track-border: #4a5568;
    --progress-text-color: #e2e8f0;
    --progress-shadow-light: rgba(255, 255, 255, 0.1);
    --progress-shadow-dark: rgba(0, 0, 0, 0.3);
  }
  
  .linearTrack {
    background: linear-gradient(145deg, #2d3748, #1a202c);
    box-shadow: 
      inset 0 2px 4px rgba(0, 0, 0, 0.3),
      0 1px 2px rgba(255, 255, 255, 0.1);
  }
  
  .circularSvg {
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
  }
}
